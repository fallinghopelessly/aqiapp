<!DOCTYPE html>
<html  >
<head>
  
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v5.3.10, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/logo.jpg" type="image/x-icon">
  <meta name="description" content="">
  
  
  <title>Prediction</title>
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  
  <script src="https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.js"></script>
  
      <link href="https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css" rel="stylesheet" />
      <style>
        body {
          margin: 0;
          padding: 0;
        }
      </style>
  
  
</head>
<body>
  
  <section class="menu menu1 cid-sFq6EQlwBn" once="menu" id="menu1-y">
    

    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container">
            <div class="navbar-brand">
                
                <span class="navbar-caption-wrap"><a class="navbar-caption text-black display-7" href = "http://127.0.0.1:5000/">AQI Prediction&nbsp;</a></span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="http://127.0.0.1:5000/">Home</a></li>
                    <li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="http://127.0.0.1:5000/aqi">AQI</a></li>
                    <li class="nav-item"><a class="nav-link link text-black text-primary display-4" href="http://127.0.0.1:5000/prediction">Prediction</a>
                    </li></ul>
                
                
            </div>
        </div>
    </nav>
</section>



<section class="content7 cid-sFur2dYKeo" id="content7-17">
    <div class="container">
        <div class="row justify-content-center">  
<div class="row my-4">
    <div class="col-md-6">
        <!--<h3>Turn on your location </h3>

        <button type="submit" class="btn btn-primary my-1 btn-block" onclick="getLocation()">Turn on location</button>
        
        <p id="demo"></p>
        
        <script>
        var x = document.getElementById("demo");
        
        function getLocation() {
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
          } else { 
            x.innerHTML = "Geolocation is not supported by this browser.";
          }
        }
        
        function showPosition(position) {
          x.innerHTML = "Latitude: " + position.coords.latitude + 
          "<br>Longitude: " + position.coords.longitude;
          
    
        }
    </script>-->

    <div class="root">
		
		<div class="location-container">
			<h3 class="sub-heading">Turn on your location :</h3>
			<label for="error-msg" style="color: red;"></label><br />
			<input
				type="number"
				name="lat"
				placeholder="Latitude"
				id="latitude"
				step="0.0001"
				class="loc-input" />
			
			<input
				type="number"
				name="lon"
				placeholder="Longitude"
				id="longitude"
				step="0.0001"
				class="loc-input" />
			<button class="search-btn">Search</button>
		</div>
		<div class="air-info">
			<h3 class="sub-heading">AQI </h3>
			<span class="air-quality">...</span>
			<span class="arr">&nbsp;&rarr;&nbsp;</span>
			<span class="air-quality-status">...</span>
			<div class="component-container">
				<h4 class="sub-heading">
					Pollutants in the air 
				</h4>

				<div>
					<h5 class="component-names">Carbon Monoxide :</h5>
					<span class="component-val" data-comp="co"></span>
				</div>
				<div>
					<h5 class="component-names">Nitrogen Monoxide :</h5>
					<span class="component-val" data-comp="no"></span>
				</div>
				<div>
					<h5 class="component-names">Nitrogen Dioxide :</h5>
					<span class="component-val" data-comp="no2"></span>
				</div>
				<div>
					<h5 class="component-names">Ozone :</h5>
					<span class="component-val" data-comp="o3"></span>
				</div>
				<div>
					<h5 class="component-names">Sulphur Dioxide :</h5>
					<span class="component-val" data-comp="so2"></span>
				</div>
				<div>
					<h5 class="component-names">Fine particles matter :</h5>
					<span class="component-val" data-comp="pm2_5"></span>
				</div>
				<div>
					<h5 class="component-names">Coarse particulate matter :</h5>
					<span class="component-val" data-comp="pm10"></span>
				</div>
				<div>
					<h5 class="component-names">Ammonia :</h5>
					<span class="component-val" data-comp="nh3"></span>
				</div>
				<!--  micrograms per cubic meter of air (μg/m3)  -->
			</div>
		</div>
		</div>
	<script>
		
		const errorLabel = document.querySelector("label[for='error-msg']")
const latInp = document.querySelector("#latitude")
const lonInp = document.querySelector("#longitude")
const airQuality = document.querySelector(".air-quality")
const airQualityStat = document.querySelector(".air-quality-status")
const srchBtn = document.querySelector(".search-btn")
const componentsEle = document.querySelectorAll(".component-val")

const appId = "b22576974908255906c4f0da13015287" // Get your own API Key from https://home.openweathermap.org/api_keys
const link = "https://api.openweathermap.org/data/2.5/air_pollution"	// API end point

const getUserLocation = () => {
	// Get user Location
	if (navigator.geolocation) {
		navigator.geolocation.getCurrentPosition(onPositionGathered, onPositionGatherError)
	} else {
		onPositionGatherError({ message: "Can't Access your location. Please enter your co-ordinates" })
	}
}

const onPositionGathered = (pos) => {
	let lat = pos.coords.latitude.toFixed(4), lon = pos.coords.longitude.toFixed(4)

	// Set values of Input for user to know
	latInp.value = lat
	lonInp.value = lon

	// Get Air data from weather API
	getAirQuality(lat, lon)
}

const getAirQuality = async (lat, lon) => {
	// Get data from api
	const rawData = await fetch(`${link}?lat=${lat}&lon=${lon}&appid=${appId}`).catch(err => {
		onPositionGatherError({ message: "Something went wrong. Check your internet conection." })
		console.log(err)
	})
	const airData = await rawData.json()
	setValuesOfAir(airData)
	setComponentsOfAir(airData)
}

const setValuesOfAir = airData => {
	const aqi = airData.list[0].main.aqi
	let airStat = "", color = ""

	// Set Air Quality Index
	airQuality.innerText = aqi

	// Set status of air quality

	switch (aqi) {
		case 1:
			airStat = "Good"
			color = "rgb(19, 201, 28)"
			break
			case 2:
				airStat = "Fair"
				color = "rgb(15, 134, 25)"
				break
			case 3:
				airStat = "Moderate"
				color = "rgb(201, 204, 13)"
				break
			case 4:
				airStat = "Poor"
				color = "rgb(204, 83, 13)"
				break
		case 5:
			airStat = "Very Poor"
			color = "rgb(204, 13, 13)"
			break
		default:
			airStat = "Unknown"
	}

	airQualityStat.innerText = airStat
	airQualityStat.style.color = color
}

const setComponentsOfAir = airData => {
	let components = {...airData.list[0].components}
	componentsEle.forEach(ele => {
		const attr = ele.getAttribute('data-comp')
		ele.innerText = components[attr] += " μg/m³"
	})
}

const onPositionGatherError = e => {
	errorLabel.innerText = e.message
}

srchBtn.addEventListener("click", () => {
	getAirQuality(parseFloat(latInp.value).toFixed(4), parseFloat(lonInp.value).toFixed(4))
})

getUserLocation()

	</script>


        
        
     
       
       <h3>or Enter manually</h3>

        <form method="POST" , action="/prediction">
            <div class="form-row">
                <div class="col-6">
                    <input type="text" class="form-control my-1" placeholder="Average Temperature (°C)"
                        name='T' required>
                </div>
                <div class="col-6">
                    <input type="text" class="form-control my-1" placeholder="Maximum Temperature (°C)"
                        name='TM' required>
                </div>
                <div class="col-4">
                    <input type="text" class="form-control my-1" placeholder="Min Temp(°C)" name='Tm'
                        required>
                </div>
                <div class="col-8">
                    <input type="text" class="form-control my-1"
                        placeholder="Atmospheric pressure at sea level (hPa)" name='SLP' required>
                </div>
                <div class="col-6">
                    <input type="text" class="form-control my-1" placeholder="Average relative humidity (%)"
                        name='H' required>
                </div>
                <div class="col-7">
                    <input type="text" class="form-control my-1" placeholder="Avg visibility (Km)" name='VV'
                        required>
                </div>
                <div class="col-5">
                    <input type="text" class="form-control my-1" placeholder="Avg wind speed (Km/h)"
                        name='V' required>
                </div>
                <div class="col-9">
                    <input type="text" class="form-control my-1"
                        placeholder="Maximum sustained wind speed (Km/h)" name='VM' required>
                </div>
                <div class="col-3">
                    <button type="submit" class="btn btn-primary my-1 btn-block">Predict</button>
                </div>
            </div>
        </div>
            </div>
        </form>
    </div>

    
</section>
<!--Prediction-->
<section class="content7 cid-sFur2dYKeo" id="content7-17">
    
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-10">
                <blockquote>
                <h5 class="mbr-section-title mbr-fonts-style mb-2 display-7"><strong>Prediction</strong></h5>
                <p class="mbr-text mbr-fonts-style display-4">

        {% if lr_pm %}
        {% if lr_pm < 51 %}
        <h4 class="text text-success">Predicted value of PM<sub>2.5</sub> is {{ lr_pm[0] }} μg/m3, GOOD.
        <br><br>
        The AQI value for your community is between  
        0 and 50. Air quality is satisfactory and poses little or no 
        health risk. </h4>
        {% elif lr_pm < 101 %}
        <h4 class="text text-info">Predicted value of PM<sub>2.5</sub> is {{ lr_pm[0] }} μg/m3, MODERATE.
            <br><br>
            The AQI is between 51 and 100. Air quality 
is acceptable; however, pollution in this range may pose a 
moderate health concern for a very small number of individuals. People who are unusually sensitive to ozone or 
particle pollution may experience respiratory symptoms. 
        </h4>
        {% elif lr_pm < 151 %}
        <h4 class="text text-primary">Predicted value of PM<sub>2.5</sub> is {{ lr_pm[0] }} μg/m3, UNHEALTHY
            FOR SENSITIVE GROUPS i.e Kids. <br><br>
            Members of sensitive groups 
            may experience health effects, but the general public is 
            unlikely to be affected. <br>
            •  Ozone: People with lung disease, children, older adults, 
            and people who are active outdoors are considered 
            sensitive and therefore at greater risk.<br>
            •  Particle pollution: People with heart or lung disease, 
            older adults,1 and children are considered sensitive and 
            therefore at greater risk.</h4>
        {% elif lr_pm < 201 %}
        <h4 class="text text-warning">Predicted value of PM<sub>2.5</sub> is {{ lr_pm[0] }} μg/m3, UNHEALTHY.
            <br>
            <br>
            Everyone may begin to experience health effects 
            when AQI values are between 151 and 200. Members of 
            sensitive groups may experience more serious health effects.
        </h4>
        {% elif lr_pm < 301 %}
        <h4 class="text text-danger">Predicted value of PM<sub>2.5</sub> is {{ lr_pm[0] }} μg/m3, VERY
            UNHEALTHY. <br> <br>
            AQI values between 201 and 300 
            trigger a health alert, meaning everyone may experience 
            more serious health effects. </h4>
        {% else %}
        <h4 class="text text-danger">Predicted value of PM<sub>2.5</sub> is {{ lr_pm[0] }} μg/m3, HAZARDOUS. <br><br>
            AQI values over 300 trigger health warnings of emergency conditions. The entire population is even more likely to be affected by serious health effects.
        </h4>
        {% endif %}
        {% endif %}

                </p></blockquote>
            </div>
        </div>
    </div>
</section>


    
<!--MAP-->

<div id="map" style="width: 1400px; height: 600px;"></div>
      <script>
        var apiKey = "754636f8faa543779ba96c98fc44c761"; // Your BreezoMeter API key
        var mapBoxAccessToken = "pk.eyJ1Ijoia2FuYWtiaXNodCIsImEiOiJja3M0cGM1MHgycHMzMndzNzBzdXlvZm1yIn0.14cnZ7kLONsV68veheRQtg"; // your mapbox access token from: https://account.mapbox.com
  
        var errorMessageBrz =
          "Update the variable 'apiKey' with a BreezoMeter API key to see the tiles. Contact BreezoMeter if you need any help:    breezometer.com/contact-us";
        var errorMessageMapbox =
          "Update the variable 'mapBoxAccessToken' with a Mapbox Access Token to initialize the Mapbox SDK. You can get it from:                https://account.mapbox.com";
  
        if (apiKey === "") alert(errorMessageBrz);
        if (mapBoxAccessToken === "") alert(errorMessageMapbox);
  
        var map = new mapboxgl.Map({
          container: "map",
          style: "mapbox://styles/mapbox/streets-v11", // your stylesheet location
          center: [77.61552879999999,13.1203632], // starting position [lng, lat]
          zoom: 12, // starting zoom
          accessToken: mapBoxAccessToken
        });
  
        map.on("load", function() {
          addRasterSource();
          addRasterLayer();
        });
  
        function addRasterSource() {
          map.addSource("breezometer-tiles", {
            type: "raster",
            tiles: [
              `https://tiles.breezometer.com/v1/air-quality/breezometer-aqi/current-conditions/{z}/{x}/{y}.png?key=${apiKey}&breezometer_aqi_color=indiper`
            ],
            tileSize: 256,
            maxzoom: 8
          });
        }
  
        function addRasterLayer() {
          map.addLayer(
            {
              id: "breezometer-tiles",
              type: "raster",
              source: "breezometer-tiles",
              minzoom: 0,
              maxzoom: 22,
              paint: {
                "raster-opacity": 0.6
              }
            },
            "admin-1-boundary-bg"
          );
        }
      </script>
    
    

    
<!--INSIGHTS-->
<section class="image1 cid-sFuqI8JloB" id="image1-16">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-12 col-lg-6">
                <div class="image-wrapper">
                    <img src="assets/images/aqihealth.png" alt="">
                    <p class="mbr-description mbr-fonts-style pt-2 align-center display-4">
                    AQI range</p>
                </div>
            </div>
            <div class="col-12 col-lg">
                <div class="text-wrapper">
                    <h3 class="mbr-section-title mbr-fonts-style mb-3 display-5"><strong>Insights Gained</strong></h3>
                    <p class="mbr-text mbr-fonts-style display-7">The predicted value will tell us what the level of PM2.5 is like this. The following map is integrated using Breezometer and Mapbox API. The color scheme tells us what the air is like across our location. </p>
                </div>
            </div>
            <div class="mbr-section-btn"><a class="btn btn-primary display-4" href="http://localhost:8501/" target="_blank">See the EDA</a></div>
            </div>
        </div>
    </div>
</section>



<!--Footer-->
<section class="footer7 cid-sFua0HDrDS" once="footers" id="footer7-12">


    <div class="container">
        <div class="media-container-row align-center mbr-white">
            <div class="col-12">
                <p class="mbr-text mb-0 mbr-fonts-style display-7">Final year Project built by 20CS11</p>
            </div>
        </div>
    </div>
</section><section style="background-color: #fff; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif; color:#aaa; font-size:12px; padding: 0; align-items: center; display: flex;"><a href="https://mobirise.site/w" style="flex: 1 1; height: 3rem; padding-left: 1rem;"></a><p style="flex: 0 0 auto; margin:0; padding-right:1rem;"><a href="https://mobirise.site/g" style="color:#aaa;"></a></p></section><script src="assets/web/assets/jquery/jquery.min.js"></script>  <script src="assets/popper/popper.min.js"></script>  <script src="assets/tether/tether.min.js"></script>  <script src="assets/bootstrap/js/bootstrap.min.js"></script>  <script src="assets/smoothscroll/smooth-scroll.js"></script>  <script src="assets/dropdown/js/nav-dropdown.js"></script>  <script src="assets/dropdown/js/navbar-dropdown.js"></script>  <script src="assets/touchswipe/jquery.touch-swipe.min.js"></script>  <script src="assets/theme/js/script.js"></script>  
  
  
</body>
</html>